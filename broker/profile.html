<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - Rento</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../styles.css">
    <style>
        .profile-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 40px;
            border-radius: 16px;
            margin-bottom: 32px;
            display: flex;
            align-items: center;
            gap: 32px;
        }

        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: white;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            font-weight: 700;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            flex-shrink: 0;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .profile-avatar:hover {
            transform: scale(1.05);
        }

        .profile-info {
            flex: 1;
        }

        .profile-name {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .profile-title {
            font-size: 1.25rem;
            opacity: 0.9;
            margin-bottom: 16px;
        }

        .profile-badges {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .badge {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 500;
            backdrop-filter: blur(10px);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: white;
            padding: 24px;
            border-radius: 16px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            text-align: center;
            transition: transform 0.2s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            background: var(--primary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 16px;
            color: white;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 8px;
        }

        .stat-label {
            color: var(--text-gray);
            font-weight: 500;
        }

        .profile-sections {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 32px;
        }

        .section-card {
            background: white;
            padding: 32px;
            border-radius: 16px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 24px;
        }

        .rating-display {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
        }

        .rating-score {
            font-size: 3rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .stars {
            display: flex;
            gap: 4px;
        }

        .star {
            color: #fbbf24;
            font-size: 1.5rem;
        }

        .star.empty {
            color: #e5e7eb;
        }

        .rating-breakdown {
            margin-bottom: 24px;
        }

        .rating-row {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 8px;
        }

        .rating-bar {
            flex: 1;
            height: 8px;
            background: #f3f4f6;
            border-radius: 4px;
            overflow: hidden;
        }

        .rating-fill {
            height: 100%;
            background: var(--primary-color);
            transition: width 0.3s ease;
        }

        .recent-reviews {
            max-height: 400px;
            overflow-y: auto;
        }

        .review-item {
            padding: 16px 0;
            border-bottom: 1px solid #f3f4f6;
        }

        .review-item:last-child {
            border-bottom: none;
        }

        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .reviewer-name {
            font-weight: 600;
            color: var(--text-dark);
        }

        .review-date {
            color: var(--text-gray);
            font-size: 0.875rem;
        }

        .review-stars {
            display: flex;
            gap: 2px;
            margin-bottom: 8px;
        }

        .review-text {
            color: var(--text-gray);
            line-height: 1.5;
        }

        .achievement-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px 0;
            border-bottom: 1px solid #f3f4f6;
        }

        .achievement-item:last-child {
            border-bottom: none;
        }

        .achievement-icon {
            width: 50px;
            height: 50px;
            background: var(--primary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .achievement-info {
            flex: 1;
        }

        .achievement-title {
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 4px;
        }

        .achievement-desc {
            color: var(--text-gray);
            font-size: 0.875rem;
        }

        .edit-profile-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .edit-profile-btn:hover {
            background: var(--primary-dark);
        }

        .contact-info {
            margin-bottom: 24px;
        }

        .contact-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 0;
            color: var(--text-gray);
        }

        .contact-item svg {
            color: var(--primary-color);
        }

        @media (max-width: 768px) {
            .profile-sections {
                grid-template-columns: 1fr;
            }

            .profile-header {
                flex-direction: column;
                text-align: center;
                padding: 32px 24px;
            }

            .profile-name {
                font-size: 2rem;
            }

            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container nav-content">
            <img src="../assets/rento-logo-dark.svg" alt="Rento" class="nav-logo">
            
            <ul class="nav-links">
                <li><a href="listings.html">Listings</a></li>
                <li><a href="wallet.html">Wallet</a></li>
                <li><a href="leads.html">Leads</a></li>
                <li><a href="profile.html" class="active">Profile</a></li>
            </ul>
            
            <div class="user-menu">
                <div style="background: var(--primary-color); color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; cursor: pointer;" onclick="toggleDropdown()" id="userInitials">JD</div>
                <div class="dropdown-menu" id="dropdownMenu">
                    <a href="profile.html" class="dropdown-item">Profile</a>
                    <a href="#" class="dropdown-item" onclick="openAccountSwitcher()">Switch Account</a>
                    <a href="#" class="dropdown-item logout-btn" onclick="logout()">Logout</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="dashboard-container">
        <!-- Profile Header -->
        <div class="profile-header">
            <div class="profile-avatar" id="profileAvatar" onclick="editProfile()">JD</div>
            <div class="profile-info">
                <div class="profile-name" id="profileName">John Doe</div>
                <div class="profile-title">Licensed Property Broker</div>
                <div class="profile-badges">
                    <span class="badge">Verified Broker</span>
                    <span class="badge">Top Rated</span>
                    <span class="badge">3+ Years</span>
                </div>
            </div>
            <button class="edit-profile-btn" onclick="editProfile()">
                <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"/>
                </svg>
                Edit Profile
            </button>
        </div>

        <!-- Performance Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">
                    <svg width="24" height="24" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10.707 2.293a1 1 0 00-1.414 0l-9 9a1 1 0 001.414 1.414L2 12.414V17a1 1 0 001 1h3a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1h3a1 1 0 001-1v-4.586l.293.293a1 1 0 001.414-1.414l-9-9z"/>
                    </svg>
                </div>
                <div class="stat-number">42</div>
                <div class="stat-label">Properties Managed</div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">
                    <svg width="24" height="24" fill="currentColor" viewBox="0 0 20 20">
                        <path fillRule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd"/>
                    </svg>
                </div>
                <div class="stat-number">156</div>
                <div class="stat-label">Successful Deals</div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">
                    <svg width="24" height="24" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                </div>
                <div class="stat-number">98%</div>
                <div class="stat-label">Satisfaction Rate</div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">
                    <svg width="24" height="24" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.305 2.305 0 01-.567-.267C8.07 8.34 8 8.114 8 8c0-.114.07-.34.433-.582zM11 12.849v-1.698c.22.071.412.164.567.267.364.243.433.468.433.582 0 .114-.07.34-.433.582a2.305 2.305 0 01-.567.267z"/>
                        <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.535 4.535 0 00-1.676.662C6.602 6.234 6 7.009 6 8c0 .99.602 1.765 1.324 2.246.48.32 1.054.545 1.676.662v1.941c-.391-.127-.68-.317-.843-.504a1 1 0 10-1.51 1.31c.562.649 1.413 1.076 2.353 1.253V15a1 1 0 102 0v-.092a4.535 4.535 0 001.676-.662C13.398 13.766 14 12.991 14 12c0-.99-.602-1.765-1.324-2.246A4.535 4.535 0 0011 9.092V7.151c.391.127.68.317.843.504a1 1 0 101.511-1.31c-.563-.649-1.413-1.076-2.354-1.253V5z" clipRule="evenodd"/>
                    </svg>
                </div>
                <div class="stat-number">2.4M</div>
                <div class="stat-label">Total Earnings (UGX)</div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="profile-sections">
            <!-- Left Column -->
            <div>
                <!-- Ratings & Reviews -->
                <div class="section-card">
                    <h2 class="section-title">Ratings & Reviews</h2>
                    
                    <div class="rating-display">
                        <div class="rating-score">4.8</div>
                        <div>
                            <div class="stars">
                                <span class="star">★</span>
                                <span class="star">★</span>
                                <span class="star">★</span>
                                <span class="star">★</span>
                                <span class="star">★</span>
                            </div>
                            <div style="color: var(--text-gray); margin-top: 4px;">Based on 127 reviews</div>
                        </div>
                    </div>

                    <div class="rating-breakdown">
                        <div class="rating-row">
                            <span>5 stars</span>
                            <div class="rating-bar">
                                <div class="rating-fill" style="width: 78%"></div>
                            </div>
                            <span style="color: var(--text-gray);">78%</span>
                        </div>
                        <div class="rating-row">
                            <span>4 stars</span>
                            <div class="rating-bar">
                                <div class="rating-fill" style="width: 15%"></div>
                            </div>
                            <span style="color: var(--text-gray);">15%</span>
                        </div>
                        <div class="rating-row">
                            <span>3 stars</span>
                            <div class="rating-bar">
                                <div class="rating-fill" style="width: 5%"></div>
                            </div>
                            <span style="color: var(--text-gray);">5%</span>
                        </div>
                        <div class="rating-row">
                            <span>2 stars</span>
                            <div class="rating-bar">
                                <div class="rating-fill" style="width: 2%"></div>
                            </div>
                            <span style="color: var(--text-gray);">2%</span>
                        </div>
                        <div class="rating-row">
                            <span>1 star</span>
                            <div class="rating-bar">
                                <div class="rating-fill" style="width: 0%"></div>
                            </div>
                            <span style="color: var(--text-gray);">0%</span>
                        </div>
                    </div>

                    <div class="recent-reviews">
                        <div class="review-item">
                            <div class="review-header">
                                <span class="reviewer-name">Sarah Johnson</span>
                                <span class="review-date">2 days ago</span>
                            </div>
                            <div class="review-stars">
                                <span class="star">★</span>
                                <span class="star">★</span>
                                <span class="star">★</span>
                                <span class="star">★</span>
                                <span class="star">★</span>
                            </div>
                            <p class="review-text">Excellent service! John helped me find the perfect apartment in Muyenga. Very professional and responsive to all my questions. Highly recommended!</p>
                        </div>

                        <div class="review-item">
                            <div class="review-header">
                                <span class="reviewer-name">Michael Okello</span>
                                <span class="review-date">1 week ago</span>
                            </div>
                            <div class="review-stars">
                                <span class="star">★</span>
                                <span class="star">★</span>
                                <span class="star">★</span>
                                <span class="star">★</span>
                                <span class="star">★</span>
                            </div>
                            <p class="review-text">Great experience working with John. He understood exactly what I was looking for and found several good options quickly. The whole process was smooth.</p>
                        </div>

                        <div class="review-item">
                            <div class="review-header">
                                <span class="reviewer-name">Patricia Namuli</span>
                                <span class="review-date">2 weeks ago</span>
                            </div>
                            <div class="review-stars">
                                <span class="star">★</span>
                                <span class="star">★</span>
                                <span class="star">★</span>
                                <span class="star">★</span>
                                <span class="star empty">☆</span>
                            </div>
                            <p class="review-text">Very helpful and knowledgeable about different areas in Kampala. John went above and beyond to ensure I got a good deal. Minor communication delays but overall satisfied.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column -->
            <div>
                <!-- Contact Information -->
                <div class="section-card">
                    <h3 class="section-title">Contact Information</h3>
                    <div class="contact-info">
                        <div class="contact-item">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"/>
                                <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"/>
                            </svg>
                            john.doe@rento.com
                        </div>
                        <div class="contact-item">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"/>
                            </svg>
                            +256 700 123 456
                        </div>
                        <div class="contact-item">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                <path fillRule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clipRule="evenodd"/>
                            </svg>
                            Kampala, Uganda
                        </div>
                    </div>
                </div>

                <!-- Achievements -->
                <div class="section-card">
                    <h3 class="section-title">Achievements</h3>
                    <div class="achievement-item">
                        <div class="achievement-icon">
                            <svg width="24" height="24" fill="currentColor" viewBox="0 0 20 20">
                                <path fillRule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd"/>
                            </svg>
                        </div>
                        <div class="achievement-info">
                            <div class="achievement-title">Top Performer</div>
                            <div class="achievement-desc">Highest rated broker this month</div>
                        </div>
                    </div>

                    <div class="achievement-item">
                        <div class="achievement-icon">
                            <svg width="24" height="24" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </div>
                        <div class="achievement-info">
                            <div class="achievement-title">100 Deals Milestone</div>
                            <div class="achievement-desc">Completed 100+ successful transactions</div>
                        </div>
                    </div>

                    <div class="achievement-item">
                        <div class="achievement-icon">
                            <svg width="24" height="24" fill="currentColor" viewBox="0 0 20 20">
                                <path fillRule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clipRule="evenodd"/>
                            </svg>
                        </div>
                        <div class="achievement-info">
                            <div class="achievement-title">Customer Favorite</div>
                            <div class="achievement-desc">98% customer satisfaction rate</div>
                        </div>
                    </div>

                    <div class="achievement-item">
                        <div class="achievement-icon">
                            <svg width="24" height="24" fill="currentColor" viewBox="0 0 20 20">
                                <path fillRule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clipRule="evenodd"/>
                            </svg>
                        </div>
                        <div class="achievement-info">
                            <div class="achievement-title">Fast Responder</div>
                            <div class="achievement-desc">Average response time under 2 hours</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Profile Modal -->
    <div id="editProfileModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Edit Profile</h2>
                <button class="modal-close" onclick="closeEditModal()">&times;</button>
            </div>
            
            <form id="editProfileForm">
                <div class="form-group">
                    <label for="fullName" class="form-label">Full Name</label>
                    <input type="text" id="fullName" class="form-input" value="John Doe" required>
                </div>

                <div class="form-group">
                    <label for="email" class="form-label">Email Address</label>
                    <input type="email" id="email" class="form-input" value="john.doe@rento.com" required>
                </div>

                <div class="form-group">
                    <label for="phone" class="form-label">Phone Number</label>
                    <input type="tel" id="phone" class="form-input" value="+256 700 123 456" required>
                </div>

                <div class="form-group">
                    <label for="location" class="form-label">Location</label>
                    <input type="text" id="location" class="form-input" value="Kampala, Uganda" required>
                </div>

                <div class="form-group">
                    <label for="bio" class="form-label">Bio</label>
                    <textarea id="bio" class="form-textarea" rows="4" placeholder="Tell clients about yourself and your expertise...">Licensed property broker with 3+ years of experience in Kampala real estate market. Specializing in residential and commercial properties.</textarea>
                </div>

                <button type="submit" class="form-button">
                    <span class="button-text">Save Changes</span>
                    <span class="loading hidden">Saving...</span>
                </button>
            </form>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="../js/auth.js"></script>
    <script src="../js/account-switcher.js"></script>
    <script>
        let currentUser = null;

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            currentUser = AuthManager.getCurrentUser();
            if (!currentUser) {
                window.location.href = '../auth/login.html';
                return;
            }

            if (currentUser.role !== 'broker') {
                window.location.href = '../auth/login.html';
                return;
            }

            // Update user info
            if (currentUser.name) {
                const initials = currentUser.name.split(' ').map(n => n[0]).join('').toUpperCase();
                document.getElementById('userInitials').textContent = initials;
                document.getElementById('profileAvatar').textContent = initials;
                document.getElementById('profileName').textContent = currentUser.name;
                document.getElementById('fullName').value = currentUser.name;
            }

            if (currentUser.email) {
                document.getElementById('email').value = currentUser.email;
            }
        });

        function editProfile() {
            document.getElementById('editProfileModal').style.display = 'flex';
        }

        function closeEditModal() {
            document.getElementById('editProfileModal').style.display = 'none';
        }

        // Edit profile form submission
        document.getElementById('editProfileForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const profileData = {
                name: document.getElementById('fullName').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                location: document.getElementById('location').value,
                bio: document.getElementById('bio').value
            };

            const button = e.target.querySelector('button[type="submit"]');
            const buttonText = button.querySelector('.button-text');
            const loading = button.querySelector('.loading');

            try {
                button.disabled = true;
                buttonText.classList.add('hidden');
                loading.classList.remove('hidden');

                // Update profile
                showNotification('Profile updated successfully!', 'success');
                
                // Update display
                document.getElementById('profileName').textContent = profileData.name;
                if (profileData.name) {
                    const initials = profileData.name.split(' ').map(n => n[0]).join('').toUpperCase();
                    document.getElementById('userInitials').textContent = initials;
                    document.getElementById('profileAvatar').textContent = initials;
                }

                closeEditModal();

            } catch (error) {
                console.error('Error updating profile:', error);
                showNotification('Error updating profile. Please try again.', 'error');
            } finally {
                button.disabled = false;
                buttonText.classList.remove('hidden');
                loading.classList.add('hidden');
            }
        });

        function toggleDropdown() {
            const dropdown = document.getElementById('dropdownMenu');
            dropdown.classList.toggle('show');
        }

        async function logout() {
            await AuthManager.signOut();
        }

        function openAccountSwitcher() {
            if (window.accountSwitcher) {
                window.accountSwitcher.openModal();
            }
        }

        // Event listeners
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.user-menu')) {
                document.getElementById('dropdownMenu').classList.remove('show');
            }
        });

        document.getElementById('editProfileModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeEditModal();
            }
        });
    </script>
</body>
</html>